{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "b943714f_1a7b3bf9",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 8704
      },
      "writtenOn": "2024-07-22T23:55:36Z",
      "side": 1,
      "message": "@brianosman, can you PTAL?\n\nNote that this CL is **not** ready to land yet - the CQ seems to report some ASAN-related failures at https://skia-review.googlesource.com/c/skcms/+/880812?tab\u003dchecks - e.g. https://chromium-swarm.appspot.com/task?id\u003d6af59f8eb4b93910.\n\nQUESTION: Could you please help me figure out how to locally run `skcms` tests (i.e. `skcms/tests.c`) under ASAN, from `skcms` repo?  I assume this means using Bazel (since it seems that `skcms` doesn\u0027t have `gn` support in it).  I\u0027ve found https://skia.org/docs/dev/testing/xsan/ but I was unable to follow the instructions there (trouble with gcloud quota + the instructions seem `gn`-focused).",
      "revId": "a183dfdf109bc15a5274e962061d1d3b2b6f26e6",
      "serverId": "5086850b-e599-37d2-8ec8-ff16aeccbf02"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "06ecd9f8_7d6fe8fa",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 5631
      },
      "writtenOn": "2024-07-23T13:28:11Z",
      "side": 1,
      "message": "Ah, sorry. You don\u0027t actually need bazel - skcms was originally developed with hand-written ninja files, and the bazel files came later (mostly for bots). Assuming you have clang/gcc in your path, you can just run `ninja` in the top level directory, and it will automatically build \u0026 test every variant that makes sense on your platform. It\u0027s possible that some of those won\u0027t work (the ninja files assume that the Android NDK is present in a particular location if you\u0027re on Linux, for example)...\n\nBut you can also run any of the specific builds with `ninja -f ninja/clang.msan` (or any other file in that folder ... there are quite a few, and they\u0027re all very simple. Look at those files, and you can probably add others if you need).\n\nNote that `depot_tools` no longer includes a `ninja` binary, so you might need to download a copy and put it somewhere in your path (https://ninja-build.org/).",
      "parentUuid": "b943714f_1a7b3bf9",
      "revId": "a183dfdf109bc15a5274e962061d1d3b2b6f26e6",
      "serverId": "5086850b-e599-37d2-8ec8-ff16aeccbf02"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "76de2d05_22c653db",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 5631
      },
      "writtenOn": "2024-07-23T13:30:10Z",
      "side": 1,
      "message": "Just to add: If you\u0027re unsure what dependencies might be needed, the python script `infra/bots/bot.py` downloads and configures everything necessary to build with ninja, on all platforms. (And it\u0027s also short \u0026 simple).",
      "parentUuid": "06ecd9f8_7d6fe8fa",
      "revId": "a183dfdf109bc15a5274e962061d1d3b2b6f26e6",
      "serverId": "5086850b-e599-37d2-8ec8-ff16aeccbf02"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "d3e9c791_2cf3975e",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 11059
      },
      "writtenOn": "2024-07-23T13:30:48Z",
      "side": 1,
      "message": "TIL!",
      "parentUuid": "76de2d05_22c653db",
      "revId": "a183dfdf109bc15a5274e962061d1d3b2b6f26e6",
      "serverId": "5086850b-e599-37d2-8ec8-ff16aeccbf02"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "2af66327_48fe3fb9",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 5631
      },
      "writtenOn": "2024-07-23T13:40:06Z",
      "side": 1,
      "message": "Yes, although I mis-spoke. It does configure things (and downloads some of the dependencies). But other dependencies (anything that\u0027s stored in CIPD?) are pre-loaded using the task system.",
      "parentUuid": "d3e9c791_2cf3975e",
      "revId": "a183dfdf109bc15a5274e962061d1d3b2b6f26e6",
      "serverId": "5086850b-e599-37d2-8ec8-ff16aeccbf02"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "21adeb41_578a432a",
        "filename": "tests.c",
        "patchSetId": 2
      },
      "lineNbr": 444,
      "author": {
        "id": 5631
      },
      "writtenOn": "2024-07-23T13:36:51Z",
      "side": 1,
      "message": "This isn\u0027t really necessary: The decision to use SIMD (or not) is made statically based on architecture and compile directives. For \"tail\" pixels, skcms copies the input into a sufficiently wide temp buffer, runs at the normal execution width, and then copies just the tail pixels from that temp buffer back to the real destination. (See the very end of `run_program` at the bottom of `Transform_inl.h`)\n\nFor testing purposes, all of the `.portable` builds force the scalar path.",
      "revId": "a183dfdf109bc15a5274e962061d1d3b2b6f26e6",
      "serverId": "5086850b-e599-37d2-8ec8-ff16aeccbf02"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "276ca3dd_6b9290df",
        "filename": "tests.c",
        "patchSetId": 2
      },
      "lineNbr": 444,
      "author": {
        "id": 8704
      },
      "writtenOn": "2024-07-23T14:39:51Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "21adeb41_578a432a",
      "revId": "a183dfdf109bc15a5274e962061d1d3b2b6f26e6",
      "serverId": "5086850b-e599-37d2-8ec8-ff16aeccbf02"
    }
  ]
}